# One-liner PowerShell script to download all files from accounting page
# Usage: .\download_accounting_oneliner.ps1

$url="http://192.168.1.149/accounting"; $dir=".\accounting_files"; if(!(Test-Path $dir)){New-Item -ItemType Directory -Path $dir -Force|Out-Null}; $html=Invoke-WebRequest -Uri $url -UseBasicParsing; $files=[regex]::Matches($html.Content, 'href="([^"]*\.(csv|acl|log|txt|pdf|doc|docx|xls|xlsx|zip|rar|xml|json|conf|cfg|ini|bak|dat|db|sql))"', [System.Text.RegularExpressions.RegexOptions]::IgnoreCase); $fileUrls=$files|ForEach-Object{$_.Groups[1].Value}|Where-Object{$_}|Sort-Object -Unique; Write-Host "Found $($fileUrls.Count) files" -ForegroundColor Cyan; $fileUrls|ForEach-Object{$fileUrl=$_; if(!$fileUrl.StartsWith("http")){$fileUrl="http://192.168.1.149/"+$fileUrl.TrimStart('/')}; $fileName=Split-Path $fileUrl -Leaf; $filePath=Join-Path $dir $fileName; $counter=1; $originalPath=$filePath; while(Test-Path $filePath){$nameWithoutExt=[System.IO.Path]::GetFileNameWithoutExtension($originalPath); $extension=[System.IO.Path]::GetExtension($originalPath); $filePath=Join-Path $dir "$nameWithoutExt($counter)$extension"; $counter++}; try{Write-Host "Downloading: $fileName" -ForegroundColor White; Invoke-WebRequest -Uri $fileUrl -OutFile $filePath -UseBasicParsing; Write-Host "  ✓ Success" -ForegroundColor Green}catch{Write-Host "  ✗ Failed: $($_.Exception.Message)" -ForegroundColor Red}}; Write-Host "Download completed! Files saved to: $dir" -ForegroundColor Green
