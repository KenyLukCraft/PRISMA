# Test one-liner to list CSV and ACL files without downloading
# Usage: .\test_csv_acl_oneliner.ps1

$url="http://192.168.1.149/accounting"; $html=Invoke-WebRequest -Uri $url -UseBasicParsing; $files=[regex]::Matches($html.Content, 'href="([^"]*\.(csv|acl))"', [System.Text.RegularExpressions.RegexOptions]::IgnoreCase); $fileUrls=$files|ForEach-Object{$_.Groups[1].Value}|Where-Object{$_}|Sort-Object -Unique; Write-Host "=== TEST MODE - CSV/ACL Files Found ===" -ForegroundColor Cyan; Write-Host "Total files found: $($fileUrls.Count)" -ForegroundColor Yellow; if($fileUrls.Count -eq 0){Write-Host "No CSV or ACL files found on the page." -ForegroundColor Red; Write-Host "Raw HTML preview (first 500 chars):" -ForegroundColor Yellow; Write-Host $html.Content.Substring(0, [Math]::Min(500, $html.Content.Length)) -ForegroundColor Gray}else{$fileUrls|ForEach-Object{$fileUrl=$_; if(!$fileUrl.StartsWith("http")){$fileUrl="http://192.168.1.149/"+$fileUrl.TrimStart('/')}; $fileName=Split-Path $fileUrl -Leaf; Write-Host "  $fileName" -ForegroundColor White; Write-Host "    URL: $fileUrl" -ForegroundColor Gray}}; Write-Host "`nTo download these files, run: .\download_csv_acl_oneliner.ps1" -ForegroundColor Green
